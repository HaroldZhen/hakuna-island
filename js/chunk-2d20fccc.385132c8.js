(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d20fccc"],{b4bf:function(e,t,o){"use strict";o.r(t);var n=o("7a23"),c={class:"d-flex justify-content-between align-items-baseline"},a=Object(n["i"])("h2",null,[Object(n["i"])("i",{class:"bi bi-bag-check p-1",style:{"font-size":"1.5rem"}}),Object(n["h"])("優惠券")],-1),i={class:"table mt-4"},l=Object(n["i"])("thead",null,[Object(n["i"])("tr",null,[Object(n["i"])("th",null,"名稱"),Object(n["i"])("th",null,"折扣百分比"),Object(n["i"])("th",null,"到期日"),Object(n["i"])("th",null,"是否啟用"),Object(n["i"])("th",null,"編輯")])],-1),u={key:0,class:"text-success"},s={key:1,class:"text-muted"},d={class:"btn-group"};function p(e,t,o,p,b,r){var O=Object(n["G"])("Pagination"),j=Object(n["G"])("CouponModal"),m=Object(n["G"])("DeleteModal");return Object(n["x"])(),Object(n["e"])(n["a"],null,[Object(n["i"])("div",c,[a,Object(n["i"])("button",{class:"btn btn-primary m-3",onClick:t[1]||(t[1]=function(){return r.openModal&&r.openModal.apply(r,arguments)})},"建立新的優惠券")]),Object(n["i"])("table",i,[l,Object(n["i"])("tbody",null,[(Object(n["x"])(!0),Object(n["e"])(n["a"],null,Object(n["E"])(b.coupons,(function(t,o){return Object(n["x"])(),Object(n["e"])("tr",{key:o},[Object(n["i"])("td",null,Object(n["J"])(t.title),1),Object(n["i"])("td",null,Object(n["J"])(t.percent)+"%",1),Object(n["i"])("td",null,Object(n["J"])(e.$filters.date(t.due_date)),1),Object(n["i"])("td",null,[1===t.is_enabled?(Object(n["x"])(),Object(n["e"])("span",u,"啟用")):(Object(n["x"])(),Object(n["e"])("span",s,"未啟用"))]),Object(n["i"])("td",null,[Object(n["i"])("div",d,[Object(n["i"])("button",{class:"btn btn-outline-primary btn-sm",onClick:function(e){return r.openModal({isNew:!1,item:t})}},"編輯",8,["onClick"]),Object(n["i"])("button",{class:"btn btn-outline-danger btn-sm",onClick:function(e){return r.openDeleteModal(t)}},"刪除",8,["onClick"])])])])})),128))])]),b.pages.total_pages?(Object(n["x"])(),Object(n["e"])(O,{key:0,pages:b.pages,"current-page":b.currentPage,onToPage:r.toPage},null,8,["pages","current-page","onToPage"])):Object(n["f"])("",!0),Object(n["i"])(j,{isNew:b.isNew,coupon:b.tempCoupon,ref:"couponModal",onNewOrUpdateCoupon:r.newOrUpdateCoupon},null,8,["isNew","coupon","onNewOrUpdateCoupon"]),Object(n["i"])(m,{item:b.tempCoupon,onDeletItem:r.deleteCoupon,ref:"deleteModal"},null,8,["item","onDeletItem"])],64)}var b=o("5530"),r=o("9de5"),O={class:"modal fade",id:"couponModal",tabindex:"-1","aria-labelledby":"couponModalLabel","aria-hidden":"true",ref:"modal"},j={class:"modal-dialog modal-lg"},m={class:"modal-content"},f={class:"modal-header"},h={class:"modal-title",id:"couponModalLabel"},C={key:0},v={key:1},w=Object(n["i"])("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),g={class:"modal-body"},M={class:"mb-3"},y=Object(n["i"])("label",{for:"title"},"標題",-1),k={class:"mb-3"},_=Object(n["i"])("label",{for:"coupon_code"},"優惠碼",-1),x={class:"mb-3"},U=Object(n["i"])("label",{for:"due_date"},"到期日",-1),N={class:"mb-3"},P=Object(n["i"])("label",{for:"price"},"折扣百分比",-1),T={class:"mb-3"},$={class:"form-check"},D=Object(n["i"])("label",{class:"form-check-label",for:"is_enabled"}," 是否啟用 ",-1),B={class:"modal-footer"},J=Object(n["i"])("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"取消",-1);function V(e,t,o,c,a,i){return Object(n["x"])(),Object(n["e"])("div",O,[Object(n["i"])("div",j,[Object(n["i"])("div",m,[Object(n["i"])("div",f,[Object(n["i"])("h5",h,[o.isNew?(Object(n["x"])(),Object(n["e"])("span",C,"新增優惠卷")):(Object(n["x"])(),Object(n["e"])("span",v,"編輯優惠卷"))]),w]),Object(n["i"])("div",g,[Object(n["i"])("div",M,[y,Object(n["T"])(Object(n["i"])("input",{type:"text",class:"form-control",id:"title","onUpdate:modelValue":t[1]||(t[1]=function(e){return a.tempCoupon.title=e}),placeholder:"請輸入標題"},null,512),[[n["O"],a.tempCoupon.title]])]),Object(n["i"])("div",k,[_,Object(n["T"])(Object(n["i"])("input",{type:"text",class:"form-control",id:"coupon_code","onUpdate:modelValue":t[2]||(t[2]=function(e){return a.tempCoupon.code=e}),placeholder:"請輸入優惠碼"},null,512),[[n["O"],a.tempCoupon.code]])]),Object(n["i"])("div",x,[U,Object(n["T"])(Object(n["i"])("input",{type:"date",class:"form-control",id:"due_date","onUpdate:modelValue":t[3]||(t[3]=function(e){return a.due_date=e})},null,512),[[n["O"],a.due_date]])]),Object(n["i"])("div",N,[P,Object(n["T"])(Object(n["i"])("input",{type:"number",class:"form-control",id:"price",min:"0","onUpdate:modelValue":t[4]||(t[4]=function(e){return a.tempCoupon.percent=e}),placeholder:"請輸入折扣百分比"},null,512),[[n["O"],a.tempCoupon.percent,void 0,{number:!0}]])]),Object(n["i"])("div",T,[Object(n["i"])("div",$,[Object(n["T"])(Object(n["i"])("input",{class:"form-check-input",type:"checkbox","true-value":1,"false-value":0,"onUpdate:modelValue":t[5]||(t[5]=function(e){return a.tempCoupon.is_enabled=e}),id:"is_enabled"},null,512),[[n["M"],a.tempCoupon.is_enabled]]),D])])]),Object(n["i"])("div",B,[J,Object(n["i"])("button",{type:"button",class:"btn btn-primary",onClick:t[6]||(t[6]=function(){return i.onUpdate&&i.onUpdate.apply(i,arguments)})},"更新優惠券")])])])],512)}o("ac1f"),o("1276");var G=o("7b17"),I={props:{coupon:{type:Object,default:function(){return{}}},isNew:{type:Boolean,default:!1}},emits:["newOrUpdateCoupon"],data:function(){return{bsModal:"",tempCoupon:{},due_date:""}},methods:{openModal:function(){this.bsModal.show()},hideModal:function(){this.bsModal.hide()},onUpdate:function(){this.$emit("newOrUpdateCoupon",this.tempCoupon),this.hideModal()}},watch:{coupon:function(){this.tempCoupon=Object(b["a"])({},this.coupon);var e=this.tempCoupon.due_date||Math.floor(Date.now()/1e3),t=new Date(1e3*e).toISOString().split("T");this.due_date=t.shift()},due_date:function(){this.tempCoupon.due_date=this.$filters.dateToTimestamp(this.due_date)}},mounted:function(){this.bsModal=new G["a"](this.$refs.modal)}};I.render=V;var L=I,S=o("1843"),z=o("1799"),E={components:{CouponModal:L,DeleteModal:S["a"],Pagination:z["a"]},data:function(){return{coupons:{},tempCoupon:{title:"",is_enabled:0,percent:100,code:""},isNew:!1,currentPage:1,pages:{}}},methods:{getCoupon:function(){var e=this;this.$swal({title:"讀取優惠卷",icon:"info",toast:!0,position:"top",showConfirmButton:!1,timer:1e3}),r["c"].get(r["a"].coupon.page(this.currentPage)).then((function(t){var o=t.data.success,n=void 0!==o&&o;if(n){var c=t.data,a=c.coupons,i=c.pagination;e.coupons=a,e.pages=Object(b["a"])({},i)}}))},toPage:function(e){this.currentPage=e,this.getCoupon()},openModal:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.isNew,o=void 0===t||t,n=e.item,c=void 0===n?{}:n;this.isNew=o,this.tempCoupon=o?{}:Object(b["a"])({},c),this.$refs.couponModal.openModal()},openDeleteModal:function(e){this.tempCoupon=Object(b["a"])({},e),this.$refs.deleteModal.openModal()},newOrUpdateCoupon:function(e){var t={data:Object(b["a"])({},e)};this.isNew?this.newCoupon(t):this.updateCoupon(t)},updateCoupon:function(e){var t=this,o=e.data.id;r["c"].put(r["a"].coupon.src(o),e).then((function(e){var o=e.data.success,n=void 0!==o&&o;n&&(t.getCoupon(t.currentPage),t.$swal({title:"更新優惠卷",icon:"success",showConfirmButton:!1,timer:1e3}))}))},newCoupon:function(e){var t=this;r["c"].post(r["a"].coupon.new,e).then((function(e){var o=e.data.success,n=void 0!==o&&o;n&&(t.getCoupon(),t.$swal({title:"已新增優惠卷",icon:"success",showConfirmButton:!1,timer:1e3}))}))},deleteCoupon:function(){var e=this;r["c"].delete(r["a"].order.src(this.tempCoupon.id)).then((function(t){var o=t.data.success,n=void 0!==o&&o;n&&(e.getCoupon(e.currentPage),e.$swal({title:"已刪除優惠卷",icon:"success",showConfirmButton:!1,timer:1e3}))}))}},created:function(){this.getCoupon()}};E.render=p;t["default"]=E}}]);
//# sourceMappingURL=chunk-2d20fccc.385132c8.js.map